(()=>{"use strict";var t={138:(t,a,e)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.LabToXYZ=a.XYZToLab=a.XYZToRGB=a.RGBToXYZ=a.LabToColor=a.ColorToLab=a.I3DXAlphaBlend=a.ARGB=a.XRGB=void 0;const r=e(555);function o(t,a,e){return r.pack(255,t,a,e)}function d(t,a,e){let r=t/255,o=a/255,d=e/255;return r>.04045?r=Math.pow((r+.055)/1.055,2.4):r/=12.92,r*=100,o>.04045?o=Math.pow((o+.055)/1.055,2.4):o/=12.92,o*=100,d>.04045?d=Math.pow((d+.055)/1.055,2.4):d/=12.92,d*=100,[.4124*r+.3576*o+.1805*d,.2126*r+.7152*o+.0722*d,.0193*r+.1192*o+.9505*d]}function n(t,a,e){const r=t/100,o=a/100,d=e/100;let n=3.2406*r+-1.5372*o+-.4986*d,s=-.9689*r+1.8758*o+.0415*d,i=.0557*r+-.204*o+1.057*d;return Math.abs(n)>.0031308?n=1.055*Math.pow(n,1/2.4)-.055:n*=12.92,Math.abs(s)>.0031308?s=1.055*Math.pow(s,1/2.4)-.055:s*=12.92,Math.abs(i)>.0031308?i=1.055*Math.pow(i,1/2.4)-.055:i*=12.92,[Math.min(Math.max(Math.round(255*n),0),255),Math.min(Math.max(Math.round(255*s),0),255),Math.min(Math.max(Math.round(255*i),0),255)]}a.XRGB=o,a.ARGB=function(t,a,e,o){return r.pack(t,a,e,o)},a.I3DXAlphaBlend=function(t,a){let[e,o,d,n]=r.unpack(t),[s,i,c,I]=r.unpack(a);if(0===s)return t;if(0===e)return a;e/=255,s/=255;let u=s+e*(1-s);const D=Math.round((i*s+o*e*(1-s))/u),l=Math.round((c*s+d*e*(1-s))/u),h=Math.round((I*s+n*e*(1-s))/u);return u=Math.min(255,Math.round(255*u)),r.pack(u,D,l,h)},a.ColorToLab=function(t){const[a,e,o,n]=r.unpack(t),[s,i,I]=d(e,o,n);return c(s,i,I)},a.LabToColor=function(t,a,e){const[r,d,s]=I(t,a,e),[i,c,u]=n(r,d,s);return o(i,c,u)},a.RGBToXYZ=d,a.XYZToRGB=n;const s=95.047,i=108.883;function c(t,a,e){let r=t/s,o=a/100,d=e/i;return r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,[116*o-16,500*(r-o),200*(o-d)]}function I(t,a,e){let r=(t+16)/116,o=a/500+r,d=r-e/200;return o=Math.pow(o,3)>.008856?Math.pow(o,3):(o-16/116)/7.787,r=Math.pow(r,3)>.008856?Math.pow(r,3):(r-16/116)/7.787,d=Math.pow(d,3)>.008856?Math.pow(d,3):(d-16/116)/7.787,[o*s,100*r,d*i]}a.XYZToLab=c,a.LabToXYZ=I},210:(t,a,e)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.I3DXDevice=a.I3DPT_TRIANGLEFAN=a.I3DPT_TRIANGLESTRIP=a.I3DPT_TRIANGLELIST=a.I3DPT_LINESTRIP=a.I3DPT_LINELIST=a.I3DPT_POINTLIST=a.I3DTS_PROJECTION=a.I3DTS_VIEW=a.I3DTS_WORLD=void 0;const r=e(555),o=e(138),d=e(31),n=e(573);a.I3DTS_WORLD="world",a.I3DTS_VIEW="view",a.I3DTS_PROJECTION="projection",a.I3DPT_POINTLIST=1,a.I3DPT_LINELIST=2,a.I3DPT_LINESTRIP=3,a.I3DPT_TRIANGLELIST=4,a.I3DPT_TRIANGLESTRIP=5,a.I3DPT_TRIANGLEFAN=6,a.I3DXDevice=class{constructor(t,e,r){this.WIDTH=e,this.HWIDTH=e/2,this.HEIGHT=r,this.HHEIGHT=r/2,this._canvas=document.createElement("canvas"),this._canvas.width=e,this._canvas.height=r,t.appendChild(this._canvas),this._ctx=this._canvas.getContext("2d"),this._backBuffer=this._ctx.createImageData(e,r);const o=n.I3DXMatrixLookAtLH(d.I3DXVector3(0,0,10),d.I3DXVector3(0,0,0),d.I3DXVector3(0,1,0)),s=n.I3DXMatrixPerspectiveFovLH(d.I3DXToRadian(45),e/r,1,100);this._transforms={[a.I3DTS_WORLD]:d.I3DXMatrixIdentity(4),[a.I3DTS_VIEW]:o,[a.I3DTS_PROJECTION]:s};const i=this.WIDTH*this.HEIGHT;this._zbufferData=new Int32Array(i),this._zbufferDepth=new Float32Array(i)}SetTransform(t,a){this._transforms[t]=a}MultiplyTransform(t,a){this._transforms[t]=d.I3DXMatrixMultiply(a,this._transforms[t])}BeginScene(){this.ZBufferClear(),this._backBuffer=this._ctx.createImageData(this.WIDTH,this.HEIGHT)}DrawPrimitive(t,e){let s;s=d.I3DXMatrixMultiply(this._transforms[a.I3DTS_VIEW],this._transforms[a.I3DTS_WORLD]),s=d.I3DXMatrixMultiply(this._transforms[a.I3DTS_PROJECTION],s);const i=d.I3DXVector3(0,0,1);switch(t){case a.I3DPT_POINTLIST:for(let t=0;t<e.length;t++){const a=d.I3DXMatrixMultiply(s,e[t].coordinates),r=a.data[0]/a.data[3],o=a.data[1]/a.data[3],n=a.data[2]/a.data[3];if(Math.abs(r)<=1&&Math.abs(o)<=1&&Math.abs(n)<=1){const a=Math.round((1-r)*this.HWIDTH),d=Math.round((1-o)*this.HHEIGHT);this.ZBufferSet(a,d,e[t].color,n)}}break;case a.I3DPT_LINELIST:case a.I3DPT_LINESTRIP:for(let o=0;o<e.length-1;o++){const n=e[o],i=e[o+1],c=d.I3DXMatrixMultiply(s,n.coordinates),I=d.I3DXMatrixMultiply(s,i.coordinates),u=c.data[0]/c.data[3],D=c.data[1]/c.data[3],l=c.data[2]/c.data[3],h=I.data[0]/I.data[3],T=I.data[1]/I.data[3],f=I.data[2]/I.data[3],[M,X,m,x]=r.unpack(e[o].color),[_,w,b,p]=r.unpack(e[o+1].color),L=_-M,S=w-X,v=b-m,A=p-x,H=t=>r.pack(Math.round(L*t+M),Math.round(S*t+X),Math.round(v*t+m),Math.round(A*t+x)),R=h-u,E=T-D,V=f-l,y=t=>[R*t+u,E*t+D,V*t+l],P=Math.round((1-u)*this.HWIDTH),N=Math.round((1-h)*this.HWIDTH),B=Math.abs(N-P);for(let t=0;t<=B;t++){const a=t/B,[e,r,o]=y(a),d=H(a);if(Math.abs(e)<1&&Math.abs(r)<1&&Math.abs(o)<1){const t=Math.round((1-e)*this.HWIDTH),a=Math.round((1-r)*this.HHEIGHT);this.ZBufferSet(t,a,d,o)}}t===a.I3DPT_LINELIST&&o++}break;case a.I3DPT_TRIANGLELIST:for(let t=0;t<e.length-2;t++){const a=d.I3DXMatrixMultiply(s,e[t].coordinates),c=d.I3DXMatrixMultiply(s,e[t+1].coordinates),I=d.I3DXMatrixMultiply(s,e[t+2].coordinates),u=d.I3DXVector3(a.data[0]/a.data[3],a.data[1]/a.data[3],a.data[2]/a.data[3]),D=d.I3DXVector3(c.data[0]/c.data[3],c.data[1]/c.data[3],c.data[2]/c.data[3]),l=d.I3DXVector3(I.data[0]/I.data[3],I.data[1]/I.data[3],I.data[2]/I.data[3]),h=d.I3DXVectorUnit(d.I3DXVectorCross(d.I3DXMatrixSubtract(D,u),d.I3DXMatrixSubtract(l,u))),T=d.I3DXVectorDot(i,u),f=d.I3DXVectorDot(h,i);if(f<=0)continue;const M=Math.round((1-u.data[0])*this.HWIDTH),X=Math.round((1-u.data[1])*this.HHEIGHT),m=Math.round((1-D.data[0])*this.HWIDTH),x=Math.round((1-D.data[1])*this.HHEIGHT),_=Math.round((1-l.data[0])*this.HWIDTH),w=Math.round((1-l.data[1])*this.HHEIGHT),b=Math.max(Math.min(X,x,w),0),p=Math.min(Math.max(X,x,w),this.HEIGHT),L=Math.max(Math.min(M,m,_),0),S=Math.min(Math.max(M,m,_),this.WIDTH),[v]=r.unpack(e[t].color),A=o.ColorToLab(e[t].color),[H]=r.unpack(e[t+1].color),R=o.ColorToLab(e[t+1].color),[E]=r.unpack(e[t+2].color),V=o.ColorToLab(e[t+2].color);for(let t=b;t<=p;t++)for(let a=L;a<=S;a++){const e=t<(w-X)/(_-M)*(a-M)+X,s=t>(w-x)/(_-m)*(a-m)+x;if(t>(x-X)/(m-M)*(a-M)+X&&e&&s){const[e,s,i]=n.I3DXBarycentricCoords(a,t,M,X,m,x,_,w),c=1-a/this.HWIDTH,I=1-t/this.HHEIGHT,u=d.I3DXVector3(c,I,0),D=(T-d.I3DXVectorDot(h,u))/f,l=A[0]*e+R[0]*s+V[0]*i,b=A[1]*e+R[1]*s+V[1]*i,p=A[2]*e+R[2]*s+V[2]*i,[L,S,y,P]=r.unpack(o.LabToColor(l,b,p)),N=r.pack(Math.round(v*e+H*s+E*i),S,y,P);this.ZBufferSet(a,t,N,D)}}}}}EndScene(){const t=this.WIDTH*this.HEIGHT*4;for(let a=0;a<t;){const[t,e,o,d]=r.unpack(this._zbufferData[a/4]);this._backBuffer.data[a++]=e,this._backBuffer.data[a++]=o,this._backBuffer.data[a++]=d,this._backBuffer.data[a++]=t}}Present(){this._ctx.putImageData(this._backBuffer,0,0)}ZBufferSet(t,a,e,d){const n=this.WIDTH*(a-1)+t,s=this._zbufferDepth[n],i=this._zbufferData[n],[c]=r.unpack(i);if(c>=255&&s<d)return;const[I]=r.unpack(e);if(I>=255&&d<s||0===c)return this._zbufferData[n]=e,void(this._zbufferDepth[n]=d);this._zbufferData[n]=d>s?o.I3DXAlphaBlend(e,i):o.I3DXAlphaBlend(i,e),d<s&&(this._zbufferDepth[n]=d)}ZBufferClear(){const t=this.WIDTH*this.HEIGHT;this._zbufferData=new Int32Array(t),this._zbufferDepth=new Float32Array(t)}}},573:(t,a,e)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.I3DXBarycentricCoords=a.I3DXMatrixOrthoLH=a.I3DXMatrixPerspectiveFovLH=a.I3DXMatrixLookToLH=a.I3DXMatrixLookAtLH=a.I3DXVertex=void 0;const r=e(31);function o(t,a,e){const o=r.I3DXVectorUnit(r.I3DXMatrixSubtract(a,t)),d=r.I3DXVectorUnit(r.I3DXVectorCross(e,o)),n=r.I3DXVectorCross(o,d),s=r.I3DXVectorDot(d,t),i=r.I3DXVectorDot(n,t),c=r.I3DXVectorDot(o,t);return new r.I3DXMatrix(4,4,[d.data[0],d.data[1],d.data[2],-s,n.data[0],n.data[1],n.data[2],-i,o.data[0],o.data[1],o.data[2],-c,0,0,0,1])}a.I3DXVertex=class{constructor(t,a,e,o){const d=r.I3DXVector(4,[t,a,e,1]);this.coordinates=d,this.color=o}},a.I3DXMatrixLookAtLH=o,a.I3DXMatrixLookToLH=function(t,a,e){return o(t,r.I3DXMatrixAdd(t,a),e)},a.I3DXMatrixPerspectiveFovLH=function(t,a,e,o){const d=1/Math.tan(t/2),n=d/a,s=o/(o-e);return new r.I3DXMatrix(4,4,[n,0,0,0,0,d,0,0,0,0,s,-e*s,0,0,1,0])},a.I3DXMatrixOrthoLH=function(t,a,e,o){const d=o-e;return new r.I3DXMatrix(4,4,[2/t,0,0,0,0,2/a,0,0,0,0,1/d,-e/d,0,0,0,1])},a.I3DXBarycentricCoords=function(t,a,e,r,o,d,n,s){const i=d-s,c=n-o,I=e-n,u=t-n,D=a-s,l=i*I+c*(r-s),h=(i*u+c*D)/l,T=((s-r)*u+I*D)/l;return[h,T,1-h-T]}},148:function(t,a,e){var r=this&&this.__createBinding||(Object.create?function(t,a,e,r){void 0===r&&(r=e),Object.defineProperty(t,r,{enumerable:!0,get:function(){return a[e]}})}:function(t,a,e,r){void 0===r&&(r=e),t[r]=a[e]}),o=this&&this.__exportStar||function(t,a){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(a,e)||r(a,t,e)};Object.defineProperty(a,"__esModule",{value:!0}),o(e(138),a),o(e(210),a),o(e(573),a),o(e(31),a)},31:(t,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.I3DXVectorUnit=a.I3DXVectorLength=a.I3DXVectorDot=a.I3DXVectorCross=a.I3DXVector3=a.I3DXVector=a.I3DXMatrixScale=a.I3DXMatrixSubtract=a.I3DXMatrixAdd=a.I3DXMatrixMultiply=a.I3DXMatrixTranspose=a.I3DXRotateZMatrix=a.I3DXRotateYMatrix=a.I3DXRotateXMatrix=a.I3DXToRadian=a.I3DXScaleMatrix=a.I3DXTranslateMatrix=a.I3DXMatrixIdentity=a.I3DXMatrix=void 0;class e{constructor(t,a,e){if(void 0===a&&(a=t),this.rows=t,this.cols=a,e){if(e.length!==t*a)throw new Error("data does not match matrix dimension");this.data=Float32Array.from(e)}else this.data=new Float32Array(t*a)}_idx(t,a){return t*this.cols+a}get(t,a){return this.data[this._idx(t,a)]}set(t,a,e){this.data[this._idx(t,a)]=e}incr(t,a,e){this.data[this._idx(t,a)]+=e}debug(){const t=[];for(let a=0;a<this.rows;a++){t.push([]);for(let e=0;e<this.cols;e++)t[a].push(this.get(a,e))}console.table(t)}}function r(t){const a=new e(t,t);for(let e=0;e<t;e++)a.set(e,e,1);return a}function o(t,a){const r=new e(t.rows,t.cols),o=t.rows*t.cols;for(let e=0;e<o;e++)r.data[e]=t.data[e]*a;return r}function d(t,a){return new e(t,1,a)}function n(t,a){if(t.rows!=a.rows||t.cols!=a.cols)throw new Error("Vectors must be the same size!");let e=0;const r=t.rows*t.cols;for(let o=0;o<r;o++)e+=t.data[o]*a.data[o];return e}function s(t){return Math.sqrt(n(t,t))}a.I3DXMatrix=e,a.I3DXMatrixIdentity=r,a.I3DXTranslateMatrix=function(t,a,e){const o=r(4);return o.set(0,3,t),o.set(1,3,a),o.set(2,3,e),o},a.I3DXScaleMatrix=function(t,a,e){const o=r(4);return o.set(0,0,t),o.set(1,1,a),o.set(2,2,e),o},a.I3DXToRadian=function(t){return t/180*Math.PI},a.I3DXRotateXMatrix=function(t){const a=r(4),e=Math.cos(t),o=Math.sin(t);return a.set(1,1,e),a.set(1,2,-o),a.set(2,1,o),a.set(2,2,e),a},a.I3DXRotateYMatrix=function(t){const a=r(4),e=Math.cos(t),o=Math.sin(t);return a.set(0,0,e),a.set(0,2,o),a.set(2,0,-o),a.set(2,2,e),a},a.I3DXRotateZMatrix=function(t){const a=r(4),e=Math.cos(t),o=Math.sin(t);return a.set(0,0,e),a.set(0,1,-o),a.set(1,0,o),a.set(1,1,e),a},a.I3DXMatrixTranspose=function(t){const a=new e(t.cols,t.rows);for(let e=0;e<t.rows;e++)for(let r=0;r<t.cols;r++)a.set(r,e,t.get(e,r));return a},a.I3DXMatrixMultiply=function(t,a){if(t.cols!==a.rows){const e=`(${t.rows},${t.cols})`,r=`(${a.rows},${a.cols})`;throw new Error(`Matrices must be multiplicable! ${e}:${r}`)}const r=new e(t.rows,a.cols);if(3===t.rows&&3===t.cols&&3===a.rows&&3===a.cols)r.data[0]=t.data[0]*a.data[0]+t.data[1]*a.data[3]+t.data[2]*a.data[6],r.data[1]=t.data[0]*a.data[1]+t.data[1]*a.data[4]+t.data[2]*a.data[7],r.data[2]=t.data[0]*a.data[2]+t.data[1]*a.data[5]+t.data[2]*a.data[8],r.data[3]=t.data[3]*a.data[0]+t.data[4]*a.data[3]+t.data[5]*a.data[6],r.data[4]=t.data[3]*a.data[1]+t.data[4]*a.data[4]+t.data[5]*a.data[7],r.data[5]=t.data[3]*a.data[2]+t.data[4]*a.data[5]+t.data[5]*a.data[8],r.data[6]=t.data[6]*a.data[0]+t.data[7]*a.data[3]+t.data[8]*a.data[6],r.data[7]=t.data[6]*a.data[1]+t.data[7]*a.data[4]+t.data[8]*a.data[7],r.data[8]=t.data[6]*a.data[2]+t.data[7]*a.data[5]+t.data[8]*a.data[8];else if(4===t.rows&&4===t.cols&&4===a.rows&&4===a.cols)r.data[0]=t.data[0]*a.data[0]+t.data[1]*a.data[4]+t.data[2]*a.data[8]+t.data[3]*a.data[12],r.data[1]=t.data[0]*a.data[1]+t.data[1]*a.data[5]+t.data[2]*a.data[9]+t.data[3]*a.data[13],r.data[2]=t.data[0]*a.data[2]+t.data[1]*a.data[6]+t.data[2]*a.data[10]+t.data[3]*a.data[14],r.data[3]=t.data[0]*a.data[3]+t.data[1]*a.data[7]+t.data[2]*a.data[11]+t.data[3]*a.data[15],r.data[4]=t.data[4]*a.data[0]+t.data[5]*a.data[4]+t.data[6]*a.data[8]+t.data[7]*a.data[12],r.data[5]=t.data[4]*a.data[1]+t.data[5]*a.data[5]+t.data[6]*a.data[9]+t.data[7]*a.data[13],r.data[6]=t.data[4]*a.data[2]+t.data[5]*a.data[6]+t.data[6]*a.data[10]+t.data[7]*a.data[14],r.data[7]=t.data[4]*a.data[3]+t.data[5]*a.data[7]+t.data[6]*a.data[11]+t.data[7]*a.data[15],r.data[8]=t.data[8]*a.data[0]+t.data[9]*a.data[4]+t.data[10]*a.data[8]+t.data[11]*a.data[12],r.data[9]=t.data[8]*a.data[1]+t.data[9]*a.data[5]+t.data[10]*a.data[9]+t.data[11]*a.data[13],r.data[10]=t.data[8]*a.data[2]+t.data[9]*a.data[6]+t.data[10]*a.data[10]+t.data[11]*a.data[14],r.data[11]=t.data[8]*a.data[3]+t.data[9]*a.data[7]+t.data[10]*a.data[11]+t.data[11]*a.data[15],r.data[12]=t.data[12]*a.data[0]+t.data[13]*a.data[4]+t.data[14]*a.data[8]+t.data[15]*a.data[12],r.data[13]=t.data[12]*a.data[1]+t.data[13]*a.data[5]+t.data[14]*a.data[9]+t.data[15]*a.data[13],r.data[14]=t.data[12]*a.data[2]+t.data[13]*a.data[6]+t.data[14]*a.data[10]+t.data[15]*a.data[14],r.data[15]=t.data[12]*a.data[3]+t.data[13]*a.data[7]+t.data[14]*a.data[11]+t.data[15]*a.data[15];else for(let e=0;e<t.rows;e++)for(let o=0;o<a.cols;o++){let d=0;for(let r=0;r<t.cols;r++)d+=t.get(e,r)*a.get(r,o);r.set(e,o,d)}return r},a.I3DXMatrixAdd=function(t,a){if(t.rows!==a.rows||t.cols!==a.cols)throw new Error("Matrices must be the same size!");const r=new e(t.rows,t.cols),o=t.rows*t.cols;for(let e=0;e<o;e++)r.data[e]=t.data[e]+a.data[e];return r},a.I3DXMatrixSubtract=function(t,a){if(t.rows!==a.rows||t.cols!==a.cols)throw new Error("Matrices must be the same size!");const r=new e(t.rows,t.cols),o=t.rows*t.cols;for(let e=0;e<o;e++)r.data[e]=t.data[e]-a.data[e];return r},a.I3DXMatrixScale=o,a.I3DXVector=d,a.I3DXVector3=function(t,a,e){return d(3,[t,a,e])},a.I3DXVectorCross=function(t,a){const e=d(3);return e.data[0]=t.data[1]*a.data[2]-t.data[2]*a.data[1],e.data[1]=t.data[2]*a.data[0]-t.data[0]*a.data[2],e.data[2]=t.data[0]*a.data[1]-t.data[1]*a.data[0],e},a.I3DXVectorDot=n,a.I3DXVectorLength=s,a.I3DXVectorUnit=function(t){return o(t,1/s(t))}},555:(t,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.sqr=a.unpack=a.pack=void 0,a.pack=function(t,a,e,r){return t<<24|a<<16|e<<8|r},a.unpack=function(t){return[(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},a.sqr=function(t){return t*t}}},a={};function e(r){var o=a[r];if(void 0!==o)return o.exports;var d=a[r]={exports:{}};return t[r].call(d.exports,d,d.exports,e),d.exports}(()=>{const t=e(148);!function(){const a=document.getElementById("indirect-container"),e=document.getElementById("camera-x"),r=document.getElementById("camera-y"),o=document.getElementById("camera-z"),d=document.getElementById("direction-x"),n=document.getElementById("direction-y"),s=document.getElementById("direction-z"),i=document.getElementById("fovy"),c=document.getElementById("red-depth-input"),I=document.getElementById("blue-depth-input"),u=[new t.I3DXVertex(2.5,-3,1,t.ARGB(255,0,0,255)),new t.I3DXVertex(-2.5,-3,1,t.ARGB(255,255,0,0)),new t.I3DXVertex(0,3,1,t.ARGB(255,0,255,0)),new t.I3DXVertex(2.5,-3,1,t.ARGB(255,0,0,255))],D=[new t.I3DXVertex(2.5,-3,0,t.ARGB(64,0,0,255)),new t.I3DXVertex(0,3,0,t.ARGB(64,0,0,255)),new t.I3DXVertex(-2.5,-3,0,t.ARGB(64,0,0,255))],l=t.I3DXMatrixIdentity(4),h=t.I3DXVector3(0,1,0),T=[new t.I3DXVertex(0,0,0,t.ARGB(128,0,0,255)),new t.I3DXVertex(3,3,0,t.ARGB(128,0,0,255)),new t.I3DXVertex(6,0,0,t.ARGB(128,0,0,255))],f=[new t.I3DXVertex(0,0,0,t.XRGB(255,0,0)),new t.I3DXVertex(3,3,0,t.XRGB(255,0,0)),new t.I3DXVertex(6,0,0,t.XRGB(255,0,0))];let M=t.I3DXVector(4,[0,0,-1,0]);const X=t.I3DXMatrixLookToLH(t.I3DXVector3(e.valueAsNumber,r.valueAsNumber,o.valueAsNumber),t.I3DXVector3(M.data[0],M.data[1],M.data[2]),h),m=t.I3DXMatrixPerspectiveFovLH(t.I3DXToRadian(i.valueAsNumber),640/480,1,100),x=new t.I3DXDevice(a,640,480);x.SetTransform(t.I3DTS_VIEW,X),x.SetTransform(t.I3DTS_PROJECTION,m),x.SetTransform(t.I3DTS_WORLD,l);let _,w=0,b=!1;const p={KeyW:!1,KeyQ:!1,KeyE:!1,KeyS:!1,KeyA:!1,KeyD:!1};function L(){const a=Date.now(),X=a-_;if(x.BeginScene(),M=t.I3DXVectorUnit(t.I3DXVector(4,[d.valueAsNumber,n.valueAsNumber,s.valueAsNumber,1])),p.KeyA){const a=t.I3DXRotateYMatrix(.005*X);M=t.I3DXMatrixMultiply(a,M)}else if(p.KeyD){const a=t.I3DXRotateYMatrix(-.005*X);M=t.I3DXMatrixMultiply(a,M)}if(d.valueAsNumber=M.data[0],n.valueAsNumber=M.data[1],s.valueAsNumber=M.data[2],p.KeyW){const a=t.I3DXMatrixScale(M,.2*X);e.valueAsNumber+=a.data[0],r.valueAsNumber+=a.data[1],o.valueAsNumber+=a.data[2]}else if(p.KeyS){const a=t.I3DXMatrixScale(M,-.2*X);e.valueAsNumber+=a.data[0],r.valueAsNumber+=a.data[1],o.valueAsNumber+=a.data[2]}if(p.KeyQ){const a=t.I3DXVectorUnit(t.I3DXVectorCross(h,M)),d=t.I3DXMatrixScale(a,.2*X/10);e.valueAsNumber+=d.data[0],r.valueAsNumber+=d.data[1],o.valueAsNumber+=d.data[2]}else if(p.KeyE){const a=t.I3DXVectorUnit(t.I3DXVectorCross(h,M)),d=t.I3DXMatrixScale(a,-.2*X/10);e.valueAsNumber+=d.data[0],r.valueAsNumber+=d.data[1],o.valueAsNumber+=d.data[2]}const m=t.I3DXMatrixLookToLH(t.I3DXVector3(e.valueAsNumber,r.valueAsNumber,o.valueAsNumber),t.I3DXVector3(M.data[0],M.data[1],M.data[2]),h),S=t.I3DXMatrixPerspectiveFovLH(t.I3DXToRadian(i.valueAsNumber),640/480,1,100);x.SetTransform(t.I3DTS_VIEW,m),x.SetTransform(t.I3DTS_PROJECTION,S),x.SetTransform(t.I3DTS_WORLD,l);const v=I.valueAsNumber,A=t.I3DXTranslateMatrix(-9,2,v);x.SetTransform(t.I3DTS_WORLD,A),x.DrawPrimitive(t.I3DPT_TRIANGLELIST,T);const H=c.valueAsNumber,R=t.I3DXTranslateMatrix(-9,2,H);x.SetTransform(t.I3DTS_WORLD,R),x.DrawPrimitive(t.I3DPT_TRIANGLELIST,f);const E=t.I3DXRotateYMatrix(w);x.SetTransform(t.I3DTS_WORLD,E),x.DrawPrimitive(t.I3DPT_TRIANGLELIST,D);const V=t.I3DXTranslateMatrix(0,0,Math.sin(w/2));x.SetTransform(t.I3DTS_WORLD,V),x.DrawPrimitive(t.I3DPT_TRIANGLELIST,u),x.EndScene(),x.Present(),w+=.005*X,b&&requestAnimationFrame(L),_=a}window.addEventListener("keydown",(function(t){t.code in p&&(p[t.code]=!0)})),window.addEventListener("keyup",(function(t){return t.code in p?p[t.code]=!1:"Enter"==t.code&&(b=!b,b&&(_=Date.now(),requestAnimationFrame(L))),t.preventDefault(),!1}),!0),x.BeginScene(),x.DrawPrimitive(t.I3DPT_TRIANGLELIST,u);const S=I.valueAsNumber,v=t.I3DXTranslateMatrix(-9,2,S);x.SetTransform(t.I3DTS_WORLD,v),x.DrawPrimitive(t.I3DPT_TRIANGLELIST,T);const A=c.valueAsNumber,H=t.I3DXTranslateMatrix(-9,2,A);x.SetTransform(t.I3DTS_WORLD,H),x.DrawPrimitive(t.I3DPT_TRIANGLELIST,f),x.EndScene(),x.Present()}()})()})();